#summary How to install jboss with daemon tools
#labels jboss,daemontools

== Install daemontools == 

{{{
su -
mkdir -p /package
chmod 1755 /package
cd /package
wget http://cr.yp.to/daemontools/daemontools-0.76.tar.gz
wget http://miac-jboss-config.googlecode.com/files/daemontools-0.76.errno.patch
tar -xzpf daemontools-0.76.tar.gz
cd admin
patch -P0 < ../daemontools-0.76.errno.patch
cd daemontools-0.76
package/install
}}}

== Install jboss 4.2.2 ==
{{{
cd /opt
wget http://garr.dl.sourceforge.net/sourceforge/jboss/jboss-4.2.2.GA.zip
jar xf jboss-4.2.2.GA.zip
}}}

== Create jboss service for daemontools ===

{{{
groupadd jboss
useradd -G jboss jboss
chown -R jboss:jboss /opt/jboss-4.2.2.GA
mkdir /var/log/jboss
chown -R jboss:jboss /var/log/jboss
}}}

*/service/jboss/run*
{{{
#!/bin/sh
export JAVA_HOME="/opt/jdk1.6.0_04"
export JAVA_OPTS="-Xmx1024M -Xms256M -server" 
exec 2>&1
exec setuidgid jboss /opt/jboss-4.2.2.GA/bin/run.sh
}}}

*/service/jboss/log/run*
{{{
#!/bin/sh
exec setuidgid jboss multilog /var/log/jboss
}}}